# 1.2.3 æ›´æ–°ä½æ¬¡

## é—®é¢˜:
**å‡†å¤‡æ•°æ®:**
```sql
create table district_products_2(
	district text not null,
    name text not null,
    price numeric(10, 3) not null,
    ranking int
);
insert into district_products_2(
	district,
    name,
    price
) values ('ä¸œåŒ—', 'æ©˜å­', 100),
		('ä¸œåŒ—', 'è‹¹æžœ', 50),
		('ä¸œåŒ—', 'è‘¡è„', 50),
		('ä¸œåŒ—', 'æŸ æª¬', 30),
		('å…³ä¸œ', 'æŸ æª¬', 100),
		('å…³ä¸œ', 'è è', 100),
		('å…³ä¸œ', 'è‹¹æžœ', 100),
		('å…³ä¸œ', 'è‘¡è„', 70),
		('å…³è¥¿', 'æŸ æª¬', 70),
		('å…³è¥¿', 'è¥¿ç“œ', 30),
		('å…³è¥¿', 'è‹¹æžœ', 20);
```

**é—®é¢˜:**
å¦‚ä¸‹æ›´æ–°rankingåˆ—:
```textmate
 district | name |  price  | ranking
----------+------+---------+---------
 ä¸œåŒ—     | æ©˜å­ | 100.000 |       1
 ä¸œåŒ—     | è‹¹æžœ |  50.000 |       2
 ä¸œåŒ—     | è‘¡è„ |  50.000 |       2
 ä¸œåŒ—     | æŸ æª¬ |  30.000 |       4
 å…³ä¸œ     | æŸ æª¬ | 100.000 |       1
 å…³ä¸œ     | è è | 100.000 |       1
 å…³ä¸œ     | è‹¹æžœ | 100.000 |       1
 å…³ä¸œ     | è‘¡è„ |  70.000 |       4
 å…³è¥¿     | æŸ æª¬ |  70.000 |       1
 å…³è¥¿     | è¥¿ç“œ |  30.000 |       2
 å…³è¥¿     | è‹¹æžœ |  20.000 |       3
```
## ç­”æ¡ˆ:
**ä½¿ç”¨è¿žæŽ¥å­æŸ¥è¯¢:**
```sql
update district_products_2 as d1
    set ranking = (select count(*) + 1
                    from district_products_2 as d2
                    where d2.district = d1.district
                        and d2.price > d1.price);
```

**ä½¿ç”¨rankå‡½æ•°:**

ðŸ¤”
